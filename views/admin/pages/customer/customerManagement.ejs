<!doctype html>
<html class="no-js" lang="en">

<head>
    <% include ../../partials/head %>
</head>

<body>


    <!-- Left Panel -->

    <% include ../../partials/leftMenu %>

    <div id="right-panel" class="right-panel">

        <!-- Header-->

        <% include ../../partials/header %>

        <!-- Header-->

        <!-- .content -->
        <div class="content mt-3">
            <div id="mess"></div>
            <div class="animated fadeIn">
                <div class="row">
                    <div class="col-md-12">
                        <div class="table-responsive">
                            <table id="mytable" class="table table-bordred table-striped">

                                <thead>
                                    <th>Tên khách hàng</th>
                                    <th>Số điện thoại</th>
                                    <th>Email</th>
                                    <th>Địa chỉ</th>
                                    <th>Lời nhắn</th>
                                    <th>Dự án quan tâm</th>
                                    <th>Xóa</th>
                                </thead>
                                <tbody>
                                    <% listCustomer.forEach((customer) => { %>
                                    <tr>
                                        <td style="width:15%;"><%= customer.Name %></td>
                                        <td style="width:10%;"><%= customer.Phone %></td>
                                        <td style="width:10%;"><%= customer.Email %></td>
                                        <td style="width:20%;"><%= customer.Address %></td>
                                        <td style="width:20%;"><%= customer.Message %></td>
                                        <td style="width:25%;"><%= customer.ProjectName %></td>
                                        <td style="width:5%;">
                                            <button class="btn btn-danger btn-sm rounded" data-toggle="modal"
                                                id="<%=customer.Id%>" data-target="#myModal">
                                                <i class="fa fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    <% }); %>
                                </tbody>
                            </table>
                        </div>
                        <% if(numPages>0) {%>
                        <ul class="pagination">
                            <% for(let i = 1;i<= numPages ;i++) { %>
                            <% if(i==page) {%>
                            <li class="page-item active">
                                <a class="page-link " href="/admin/customer?page=<%= i %>"><%= i %></a>
                            </li>
                            <% } else {%>
                            <li class="page-item">
                                <a class="page-link" href="/admin/customer?page=<%= i %>"><%= i %></a>
                            </li>
                            <% } %>
                            <% } %>
                        </ul>
                        <% } %>
                    </div>
                </div>
            </div><!-- .animated -->
        </div> <!-- .content -->

        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog" data-keyboard="false" data-backdrop="static">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Xác nhận</h3>
                        <button type="button" class="close" id="btnHide" data-dismiss="modal">&times;</button>

                    </div>
                    <div class="modal-body">
                        <p>Bạn có chắc chắn muốn xóa không ?</p>
                    </div>
                    <input type="text" hidden id="idSach" />
                    <div class="modal-footer">
                        <button class="btn btn-danger rounded" id="btnDelete">Có</button>
                        <button type="button" class="btn btn-success rounded" id="btnHide"
                            data-dismiss="modal">Không</button>
                    </div>
                </div>

            </div>
        </div>

        <script>
                var id;
                $('#myModal').on('show.bs.modal', (e) => {
                    const selector = e.relatedTarget;
                    id = parseInt(jQuery(selector).attr('id'));
                    jQuery('#btnDelete').on('click', () => {
                    jQuery.ajax({
                        url: '/admin/customer/delete/' + id,
                        method: 'DELETE',
                        data: { id: id },
                        dataType: 'text',
                        success: (response) => {
                            response = JSON.parse(response)
                            if (response.status == true) {
                                window.location.href = '/admin/customer';
                            }
                        }
                    })
                })
                });
    
            </script>
        <% include ../../partials/footer %>

</body>

</html>